{"version":3,"sources":["App.js","config.js","api/http.js","api/socket.js","api/index.js","components/fileList/index.js","components/fileTools/index.js","moduls/home/index.js","components/userAvatar/index.js","components/fileMsg/index.js","components/msgList/index.js","components/userInfo/index.js","moduls/history/index.js","moduls/chat/index.js","moduls/mq/index.js","router.js","serviceWorker.js","index.js"],"names":["App","react_default","a","createElement","className","this","props","children","Component","socketUrl","window","location","protocol","hostname","http","axios","create","timeout","baseURL","interceptors","response","use","data","code","message","error","msg","Promise","reject","request","config","userInfo","deleteFile","params","method","url","rollback","methon","uploadFile","file","formData","FormData","append","headers","Content-Type","download","document","arr","Object","keys","forEach","key","push","setAttribute","join","click","FileList","_this","fileList","name","filename","path","warning","delete","id","then","res","load","sortList","sortArr","_this$props","type","sortType","time","length","sort","b","f","s","_this2","_this$props2","map","item","size","moment","createTime","format","deleteTime","title","onClick","icon","FileTools","state","modalVisible","deleteList","upload","e","success","concat","showDelete","setState","reload","handleCancel","menuClick","sortChange","parseInt","_ref","fileArr","myfile","originalFilename","isDelete","fetch","toolsReload","_ref2","_this$state","showUploadList","customRequest","menu","es_menu","Item","es_button","shape","dropdown","overlay","modal","visible","onCancel","footer","components_fileList","Index","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","sortTypeChange","Math","random","Dragger","bind","fileTools","socket","io","callback","localStorage","getItem","myName","avatar","on","console","log","hi","emit","target","myId","setItem","user","UserAvatar","openUserAvatar","src","alt","width","height","FileMsg","loading","handleClick","picUrl","_this$props$type","bigPic","includes","imgLoading","_this$props2$file","_this$props2$type","_this$props2$name","_this$props2$size","replace","onLoad","round","MsgList","clearHistory","getMsgContent","fileType","fileMsg","assign","showBigPic","assertThisInitialized","div","getElementById","scrollTop","scrollHeight","chatList","trigger","userAvatar","hisName","from","getType","closeBigPic","centered","UserInfo","stopPropagation","avatarListShow","closeUserAvatar","find","el","classList","initAvatars","avatarList","list","addEventListener","editName","editAvatar","value","onChange","addOne","session","sessionList","getChat","Date","now","objectSpread","JSON","stringify","parse","deleteMsg","filter","setMsg","func","Chat","sendMsg","chat","sendTime","getTime","setChatList","_this$state2","URL","createObjectURL","targetChange","writeMsg","enter","event","nativeEvent","keyCode","altKey","ctrlKey","preventDefault","changeList","leftListType","userList","indexes","ack","connectTime","setLoading","_this3","_this$state3","components_userInfo","placeholder","style","color","isLeave","es_avatar","msgList","onKeyDown","autoFocus","ref","padding","MQ","Router","react_router_dom","src_App_0","react_router","component","to","Boolean","match","ReactDOM","render","router_Router","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.cbd9b2b6.chunk.js","sourcesContent":["import React, { Component } from 'react'\n// import Header from './moduls/header'\nimport './App.less'\n\nclass App extends Component {\n  render() {\n    return (\n      <div className=\"App\">\n        {/* <div className=\"header\">\n          <Header/>\n        </div> */}\n        {this.props.children}\n      </div>\n    );\n  }\n}\n\nexport default App;\n","\r\nlet baseURL = ''\r\nlet socketUrl = window.location.protocol + '//' + window.location.hostname + ':2000'\r\n\r\n// 本地环境\r\nif(process.env.NODE_ENV === 'development'){\r\n  baseURL = 'http://192.168.1.103:4000'\r\n  socketUrl = 'http://192.168.1.103:2000/'\r\n}\r\n\r\nexport {\r\n  baseURL,\r\n  socketUrl\r\n}","import axios from 'axios'\r\nimport { message } from 'antd'\r\nimport { baseURL } from '../config.js'\r\n\r\n\r\nconst http = axios.create({\r\n  timeout: 20000,\r\n  baseURL\r\n})\r\n\r\nhttp.interceptors.response.use((response) => {\r\n  // 对返回结果做点什么\r\n  if(response.data.code !== 0){\r\n    message.error(response.data.msg)\r\n    return Promise.reject(response)\r\n  }\r\n  return response.data\r\n\r\n}, (error) => {\r\n  message.error(error.message)\r\n  return Promise.reject(error);\r\n})\r\n\r\n\r\nhttp.interceptors.request.use((config) => {\r\n  // 对发送的请求做点什么\r\n  \r\n  return config;\r\n}, (error) => {\r\n  return Promise.reject(error);\r\n})\r\n\r\nexport default http","\r\nimport io from 'socket.io-client'\r\nimport { socketUrl } from '../config'\r\nlet socket = io(socketUrl)\r\n\r\nlet userInfo = null\r\nlet callback = () => {}\r\nlet received = (f) => { callback = f }\r\nlet id = localStorage.getItem('tj_chatID') || 0\r\nlet myName = localStorage.getItem('tj_chat_name') || null\r\nlet avatar = localStorage.getItem('tj_chat_avatar') || null\r\n\r\nsocket.on('news',  (data) => {\r\n  console.log(data.hi);\r\n  socket.emit('addUser', { \r\n    target: 'server', \r\n    msg: 'add me in user list', \r\n    myId: parseInt(id),\r\n    myName,\r\n    avatar\r\n  });\r\n});\r\n\r\nsocket.on('addUser', (data) => {\r\n  localStorage.setItem('tj_chatID', data.user.id)\r\n  localStorage.setItem('tj_chat_name', data.user.myName)\r\n  localStorage.setItem('tj_chat_avatar', data.user.avatar)\r\n  callback('addUser', data)\r\n})\r\n\r\nsocket.on('users', (data) => {\r\n  callback('users', data)\r\n})\r\n\r\nsocket.on('return', (data) => {\r\n  callback('return', data)\r\n})\r\n\r\nsocket.on('chat', (data) => {\r\n  callback('chat', data)\r\n})\r\n\r\nuserInfo = () => {\r\n  return {\r\n    myId: localStorage.getItem('tj_chatID') || '',\r\n    myName: localStorage.getItem('tj_chat_name') || '',\r\n    avatar: localStorage.getItem('tj_chat_avatar') || ''\r\n  }\r\n}\r\nexport{\r\n  socket,\r\n  received,\r\n  userInfo\r\n}","import http from './http.js'\r\nimport { message } from 'antd'\r\nimport { baseURL } from '../config.js'\r\n\r\n\r\nlet getAllfile = (params) => {\r\n  return http({\r\n    method: 'get',\r\n    url: '/files',\r\n    params\r\n  })\r\n}\r\n\r\nlet deleteFile = (params) => {\r\n  return http({\r\n    method: 'get',\r\n    url: '/delete',\r\n    params\r\n  })\r\n}\r\n\r\nlet deletedFiles = (params) => {\r\n  return http({\r\n    method: 'get',\r\n    url: '/deleted',\r\n    params\r\n  })\r\n}\r\n\r\nlet rollback = (params) => {\r\n  return http({\r\n    methon: 'get',\r\n    url: '/rollback',\r\n    params\r\n  })\r\n}\r\n\r\nlet uploadFile = (file) => {\r\n  let formData = new FormData();\r\n  formData.append('myfile', file);\r\n  return http({\r\n    method: 'post',\r\n    url: '/upload',\r\n    data: formData,\r\n    headers: {\r\n      'Content-Type': 'multipart/form-data'\r\n    }\r\n  })\r\n}\r\n\r\nlet download = (params) => {\r\n  if(typeof(params) !== 'object'){\r\n    message.error('传入参数错误')\r\n  }\r\n  let a = document.createElement('a'), arr = []\r\n  Object.keys(params).forEach((key) => (arr.push(key + '=' + params[key])))\r\n  a.setAttribute('href', baseURL + '/download?' + arr.join('&'))\r\n  a.click();\r\n}\r\n\r\nlet avatars = () => {\r\n  return http({\r\n    methon: 'get',\r\n    url: '/avatars'\r\n  })\r\n}\r\n\r\nexport {\r\n  getAllfile,\r\n  uploadFile,\r\n  download,\r\n  deleteFile,\r\n  deletedFiles,\r\n  rollback,\r\n  \r\n  avatars\r\n}","import React, { Component } from 'react'\r\nimport { Icon, message } from 'antd'\r\nimport moment from 'moment'\r\nimport { download, deleteFile, rollback } from '../../api'\r\nimport './style.less'\r\n\r\n\r\nclass FileList extends Component {\r\n\r\n  download = (key) => {\r\n    let file = this.props.fileList[key]\r\n    if (!file) {\r\n      message.warning('该文件不存在！')\r\n      return;\r\n    }\r\n    download({\r\n      name: file.filename,\r\n      file: file.path\r\n    })\r\n  }\r\n\r\n  delete = (key) => {\r\n    deleteFile({ key: this.props.fileList[key].id }).then((res) => {\r\n      this.props.load()\r\n    })\r\n  }\r\n\r\n  rollback = (key) => {\r\n    rollback({ key: this.props.fileList[key].id }).then((res) => {\r\n      this.props.load()\r\n    })\r\n  }\r\n\r\n  sortList = (res) => {\r\n    let sortArr = res\r\n    let { type, sortType } = this.props\r\n    let time = type !== 'deleteList' ? 'createTime' : 'deleteTime'\r\n\r\n    if(!sortArr || sortArr.length === 0){\r\n      return [];\r\n    }\r\n\r\n    // 按时间增序\r\n    if(sortType === 1){\r\n      sortArr.sort((a, b) => {\r\n        let f = a[time];\r\n        let s = b[time];\r\n\r\n        return f - s;\r\n      })\r\n    }\r\n\r\n    // 按时间降序\r\n    if(sortType === 2){\r\n      sortArr.sort((a, b) => {\r\n        let f = a[time];\r\n        let s = b[time];\r\n        \r\n        return s - f;\r\n      })\r\n    }\r\n\r\n    // 按文件名降序\r\n    if(sortType === 3){\r\n      sortArr.sort((a, b) => {\r\n        let f = a.filename;\r\n        let s = b.filename;\r\n\r\n        if(f > s){\r\n          return 1;\r\n        }\r\n        if(f === s){\r\n          return 0;\r\n        }\r\n        if(f < s){\r\n          return -1;\r\n        }\r\n        return 0\r\n      })\r\n    }\r\n\r\n    // 按文件名增序\r\n    if(sortType === 4){\r\n      sortArr.sort((a, b) => {\r\n        let f = a.filename;\r\n        let s = b.filename;\r\n\r\n        if(f > s){\r\n          return -1;\r\n        }\r\n        if(f === s){\r\n          return 0;\r\n        }\r\n        if(f < s){\r\n          return 1;\r\n        }\r\n        return 0\r\n      })\r\n    }\r\n    \r\n    return sortArr\r\n  }\r\n\r\n  render() {\r\n\r\n    let { fileList, type } = this.props;\r\n\r\n    return (\r\n      <div className=\"file-list\">\r\n        <ul>\r\n          {\r\n            this.sortList(fileList).map((item, key) => {\r\n              let filename = item.filename || '--'\r\n              let size = item.size ? (item.size + ' k') : '--'\r\n              let time = moment(item.createTime).format('YYYY-MM-DD HH:mm:ss')\r\n              if(type === 'deleteList') {\r\n                time = moment(item.deleteTime).format('YYYY-MM-DD HH:mm:ss')\r\n              }\r\n              return <li key={key}>\r\n                <div className=\"icon\"></div>\r\n                <div className=\"filename\" title={filename}>{item.filename || '--'}</div>\r\n                <div className=\"time\" title={(type === 'deleteList' ? '删除时间\\n' : '上传时间\\n') + time}>{time}</div>\r\n                <div className=\"size\" title={size}>{size}</div>\r\n                {\r\n                  type === 'deleteList' ? \r\n                  <div className=\"operation\">\r\n                    <div className=\"operation-btn\" onClick={() => this.rollback(key)}><Icon type=\"rollback\" /></div>\r\n                  </div> : \r\n                  <div className=\"operation\">\r\n                    <div className=\"operation-btn\" onClick={() => this.download(key)}><Icon type=\"download\" /></div>\r\n                    <div className=\"operation-btn\" onClick={() => this.delete(key)}><Icon type=\"delete\" /></div>\r\n                  </div>\r\n                }\r\n              </li>\r\n            })\r\n          }\r\n        </ul>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default FileList","import React, { Component } from 'react'\r\nimport { message, Modal, Upload, Button, Dropdown, Menu} from 'antd'\r\nimport { uploadFile, deletedFiles } from '../../api'\r\nimport FileList from '../fileList'\r\nimport './style.less'\r\n\r\n// const { SubMenu } = Menu;\r\n\r\nclass FileTools extends Component {\r\n\r\n  state = {\r\n    modalVisible: false,\r\n    deleteList: []\r\n  }\r\n\r\n  upload = (e) => {\r\n    uploadFile(e.file).then((res) => {\r\n      message.success(`${res.data.filename} 文件上传成功！`)\r\n\r\n      this.props.load()\r\n    })\r\n  }\r\n\r\n  showDelete = () => {\r\n    this.setState({\r\n      modalVisible: true,\r\n      reload: ''\r\n    });\r\n  }\r\n\r\n  handleCancel = () => {\r\n    this.setState({\r\n      modalVisible: false,\r\n    });\r\n  }\r\n\r\n  menuClick = (e) => {\r\n    // console.log(e)\r\n    this.props.sortChange(parseInt(e.key))\r\n  }\r\n\r\n  fetch() {\r\n    deletedFiles().then(({data}) => {\r\n      this.setState({\r\n        deleteList: data.fileArr.map((item) => ({\r\n          id: item.id,\r\n          filename: item.myfile.originalFilename,\r\n          size: item.myfile.size,\r\n          isDelete: item.isDelete,\r\n          createTime: item.createTime,\r\n          deleteTime: item.deleteTime\r\n        }))\r\n      })\r\n    })\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.fetch()\r\n  }\r\n\r\n  componentWillReceiveProps({toolsReload}){\r\n    if(toolsReload !== this.state.reload){\r\n      this.setState({\r\n        reload: toolsReload\r\n      })\r\n    }\r\n\r\n    this.fetch()\r\n  }\r\n\r\n  render() {\r\n    let { modalVisible, deleteList } = this.state\r\n    const config = {\r\n      name: 'file',\r\n      showUploadList: false,\r\n      customRequest: this.upload\r\n    }\r\n\r\n    const menu = (\r\n      <Menu onClick={this.menuClick}>\r\n        <Menu.Item key={1}>按时间增序</Menu.Item>\r\n        <Menu.Item key={2}>按时间降序</Menu.Item>\r\n        <Menu.Item key={3}>按名称增序</Menu.Item>\r\n        <Menu.Item key={4}>按名称降序</Menu.Item>\r\n      </Menu>\r\n    )\r\n    return (\r\n      <div className=\"tool-bar\">\r\n        <div className=\"tool-list\">\r\n          <Upload {...config}>\r\n            <Button type=\"primary\" shape=\"circle\" icon=\"cloud-upload\" className=\"tool-btn\" />\r\n          </Upload>\r\n          {\r\n            this.props.fileList.length >= 2 && (\r\n              <Dropdown overlay={menu}>\r\n                <Button type=\"primary\" shape=\"circle\" icon=\"ordered-list\" className=\"tool-btn\" />\r\n              </Dropdown>\r\n            )\r\n          }\r\n\r\n          {\r\n            deleteList.length > 0 &&\r\n            <Button type=\"primary\" shape=\"circle\" icon=\"delete\" className=\"tool-btn\" onClick={this.showDelete} />\r\n          }\r\n        </div>\r\n\r\n        <Modal\r\n          title=\"已删除的文件\"\r\n          visible={modalVisible}\r\n          onCancel={this.handleCancel}\r\n          footer={null}>\r\n          <FileList fileList={deleteList} load={this.props.load} type=\"deleteList\" sortType={2}/>\r\n        </Modal>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default FileTools","import React, { Component } from 'react'\r\nimport { getAllfile, uploadFile } from '../../api'\r\nimport { Upload, Icon, message } from 'antd'\r\nimport FileTools from '../../components/fileTools'\r\nimport FileList from '../../components/fileList'\r\nimport './style.less';\r\nclass Index extends Component {\r\n\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      fileList: null,\r\n      toolsReload: '',\r\n      sortType: 0,\r\n    }\r\n  }\r\n\r\n  upload = (e) => {\r\n    uploadFile(e.file).then((res) => {\r\n      message.success(`${res.data.filename} 文件上传成功！`)\r\n\r\n      this.fetch()\r\n    })\r\n  }\r\n\r\n  sortTypeChange = (key) => {\r\n    this.setState({\r\n      sortType: key\r\n    })\r\n  }\r\n\r\n  fetch() {\r\n    getAllfile().then(({ data }) => {\r\n      this.setState({ \r\n        fileList: data.fileArr.map((item) => ({\r\n          id: item.id,\r\n          filename: item.myfile.originalFilename,\r\n          size: item.myfile.size,\r\n          isDelete: item.isDelete,\r\n          createTime: item.createTime,\r\n          deleteTime: item.deleteTime,\r\n          path: item.myfile.path\r\n        })), \r\n        toolsReload: Math.random()\r\n      })\r\n    })\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.fetch()\r\n  }\r\n\r\n  render() {\r\n\r\n    let { fileList, toolsReload, sortType } = this.state;\r\n\r\n    const config = {\r\n      name: 'file',\r\n      showUploadList: false,\r\n      customRequest: this.upload\r\n    }\r\n\r\n    const Dragger = Upload.Dragger;\r\n\r\n    return (\r\n      \r\n        <div className=\"home\">\r\n\r\n          {\r\n            fileList && fileList.length > 0 ?\r\n              <div className=\"file-body\">\r\n                <FileList \r\n                  load={this.fetch.bind(this)}\r\n                  fileList={this.state.fileList}\r\n                  sortType={sortType} />\r\n                <FileTools\r\n                  load={this.fetch.bind(this)}\r\n                  fileList={this.state.fileList}\r\n                  reload={toolsReload}\r\n                  sortChange={this.sortTypeChange} />\r\n              </div> :\r\n              fileList && <div className=\"empty\">\r\n                <Dragger {...config}>\r\n                  <p className=\"ant-upload-drag-icon\">\r\n                    <Icon type=\"inbox\" />\r\n                  </p>\r\n                  <p className=\"ant-upload-text\">Click or drag file to this area to upload</p>\r\n                  <p className=\"ant-upload-hint\">\r\n                    Support for a single or bulk upload. Strictly prohibit from uploading company data or other\r\n                    band files\r\n                  </p>\r\n                </Dragger>\r\n              </div>\r\n          }\r\n\r\n        </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Index;\r\n\r\n","import React, { Component } from 'react';\r\n\r\nimport './style.less'\r\n\r\nclass UserAvatar extends Component {\r\n\r\n\r\n  render () {\r\n    let { avatar, openUserAvatar } = this.props\r\n\r\n    openUserAvatar = openUserAvatar || (() => {})\r\n    return (\r\n      <div className=\"user-avatar\">\r\n        <div className=\"user-avatar-content\" onClick={ openUserAvatar.bind(this) }>\r\n          <img src={avatar} alt=\"\" width=\"100%\" height=\"100%\"/>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default UserAvatar\r\n","\r\nimport React, { Component } from 'react';\r\nimport { download } from '../../api'\r\nimport { baseURL } from '../../config'\r\nimport './style.less'\r\n\r\nclass FileMsg extends Component {\r\n\r\n  state = {\r\n    loading: true,\r\n    type: '',\r\n  }\r\n\r\n  handleClick = (picUrl) => {\r\n    let { name, file, type='', bigPic } = this.props\r\n    if(!type.includes('image')) {\r\n      download({name, file})\r\n      return\r\n    }\r\n\r\n    bigPic(picUrl)\r\n  }\r\n  \r\n  imgLoading = () => {\r\n    this.setState({\r\n      loading: false\r\n    })\r\n  }\r\n\r\n  render () {\r\n    let { loading, file='', type='', name='', size=0 } = this.props\r\n\r\n    let picUrl = baseURL + file.replace('upload\\\\', '/')\r\n    return (\r\n      <div className=\"file-msg\" onClick={() => this.handleClick(picUrl)}>\r\n        {\r\n          type.includes('image') ? (\r\n            <div className=\"pic\">\r\n              <img \r\n                src={picUrl} alt=\"\" \r\n                onLoad={this.imgLoading.bind(this)}\r\n                className={!loading && !this.state.loading ? '' : 'hide'}\r\n                />\r\n              <img \r\n                src={file} alt=\"\"\r\n                className={!loading && !this.state.loading ? 'hide' : ''}/>\r\n            </div>\r\n          ) : (\r\n            <div className=\"file\">\r\n              <div className=\"file-left\">\r\n                <div className=\"file-icon wechat_unkown_file\"></div>\r\n              </div>\r\n              <div className=\"file-right\">\r\n                <div className=\"file-card-name\" title={name}>{name || '--'}</div>\r\n                <div className=\"file-card-size\">{Math.round(size / 1024) || '--'}KB</div>\r\n              </div>\r\n            </div>\r\n          )\r\n        }\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default FileMsg","import React, { Component } from 'react'\r\nimport { Icon, Dropdown, Menu, Modal } from 'antd'\r\nimport { baseURL } from '../../config'\r\nimport UserAvatar from '../userAvatar'\r\nimport FileMsg from '../fileMsg/'\r\nimport './style.less'\r\n\r\n\r\nclass MsgList extends Component {\r\n\r\n  state = {\r\n    bigPic: false\r\n  }\r\n\r\n  menu () {\r\n    let { clearHistory } = this\r\n    return (\r\n      <Menu>\r\n        <Menu.Item key=\"1\" onClick={clearHistory}>清空聊天记录</Menu.Item>\r\n      </Menu>\r\n    )\r\n  }\r\n\r\n  clearHistory = () => {\r\n    this.props.clearHistory()\r\n  }\r\n\r\n  componentDidUpdate (a, b) {\r\n    // 打开大图时不需要更新滚动条位置\r\n    if(this.state.bigPic === b.bigPic){\r\n      this.onLoad()\r\n    }\r\n  }\r\n\r\n  onLoad () {\r\n    var div = document.getElementById('message-box');\r\n    div.scrollTop = div.scrollHeight;\r\n  }\r\n\r\n  getMsgContent = (fileType, data, loading) => {\r\n    // 文本\r\n    if(fileType === 'text'){\r\n      return <span className=\"text-card\">{data}</span>\r\n    }\r\n    return <FileMsg {...data} loading={loading} bigPic={this.showBigPic.bind(this)}/>\r\n  }\r\n\r\n  getType (type, data) {\r\n    if(type === 'file' && (data.type + '').includes('image')){\r\n      return 'hide'\r\n    }\r\n    if(type !== 'text') {\r\n      return 'gray'\r\n    }\r\n    return ''\r\n  }\r\n\r\n  showBigPic (picUrl) {\r\n    this.setState({\r\n      bigPic: true,\r\n      picUrl\r\n    })\r\n  }\r\n\r\n  closeBigPic () {\r\n    this.setState({bigPic: false})\r\n  }\r\n\r\n  render() {\r\n    let { chatList } = this.props\r\n    return (\r\n        <div className=\"main-msg\">\r\n          <div className=\"scroll-warp\" id=\"message-box\">\r\n            <Dropdown overlay={this.menu()} trigger={['contextMenu']}>\r\n              <div className=\"msg-list\">\r\n                {\r\n                  chatList.map((item, key) => {\r\n                    return (\r\n                      <div className={'msg-list-item ' + (item.myName ? 'right' : '')} key={key}>\r\n                        <div className=\"user-avatar\">\r\n                          <UserAvatar avatar={baseURL + item.avatar}></UserAvatar>\r\n                        </div>\r\n                        <div className=\"content\">\r\n                          <div className=\"username\">{(item.myName ? item.myName : item.hisName) || item.from || 'no name'}</div>\r\n                          <div className={'bubble ' + this.getType(item.type, item.msg)}>\r\n                            {\r\n                              this.getMsgContent(item.type, item.msg, item.loading)\r\n                            }\r\n                            {\r\n                              item.loading && <div className=\"loading\"><Icon type=\"loading\" /></div>\r\n                            }\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    )\r\n                  })\r\n                }\r\n              </div>\r\n            </Dropdown>\r\n          </div>\r\n\r\n          <Modal\r\n            visible={this.state.bigPic}\r\n            onCancel={this.closeBigPic.bind(this)}\r\n            footer={[]}\r\n            width={1000}\r\n            centered\r\n            className=\"big-pic\">\r\n            <div className=\"img-preview\">\r\n              <img src={this.state.picUrl} alt=\"\"/>\r\n            </div>\r\n          </Modal>\r\n        </div>\r\n      )\r\n  }\r\n}\r\n\r\nexport default MsgList","import React, { Component } from 'react';\r\nimport { avatars } from '../../api'\r\nimport { baseURL } from '../../config'\r\nimport UserAvatar from '../userAvatar'\r\nimport './style.less'\r\n\r\n\r\nclass UserInfo extends Component {\r\n\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      avatarListShow: false\r\n    }\r\n\r\n    this.initAvatars()\r\n  }\r\n\r\n  initAvatars () {\r\n    avatars().then(res => {\r\n      this.avatarList = res.data.list\r\n    })\r\n  }\r\n\r\n  openUserAvatar = (e) => {\r\n    e.stopPropagation && e.stopPropagation()\r\n    this.setState({\r\n      avatarListShow: !this.state.avatarListShow\r\n    })\r\n  }\r\n\r\n  closeUserAvatar = (e) => {\r\n    !e.path.find(el =>  (el.classList + '').includes('user-avatar')) && (this.setState({ avatarListShow: false }))\r\n  }\r\n\r\n  componentDidMount () {\r\n    document.addEventListener('click', this.closeUserAvatar.bind(this))\r\n  }\r\n\r\n  render () {\r\n    let { myName, editName, myId, avatar, editAvatar } = this.props\r\n    return (\r\n      <div className=\"user\">\r\n        <UserAvatar \r\n          avatar={baseURL + avatar} \r\n          openUserAvatar={this.openUserAvatar.bind(this)}>\r\n        </UserAvatar>\r\n        <div className=\"user-info\">\r\n          <div className=\"user-item\">\r\n            <input className=\"user-name-input\" value={myName} onChange={editName} />\r\n          </div>\r\n          <div className=\"user-item\"><span>{myId}</span></div>\r\n        </div>\r\n\r\n        {\r\n          this.state.avatarListShow && <div className=\"avatar-list\">\r\n            {\r\n              this.avatarList.map((item, key) => {\r\n                return (\r\n                  <div className={'avatar-item' + (item === avatar ? ' active' : '')} key={key} onClick={() => {editAvatar(item)}}>\r\n                    <img src={baseURL + item} alt=\"\"/>\r\n                  </div>\r\n                )\r\n              })\r\n            }\r\n          </div>\r\n        }\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default UserInfo","\r\nlet storageKey = 'msg'\r\n\r\n// 添加一条聊天记录\r\nlet addOne = (session, msg) => {\r\n  // 获取\r\n  let sessionList = getChat()\r\n  let id = Date.now()\r\n  // 聊天是否以存在\r\n  if(!sessionList[session]){\r\n    sessionList[session] = [{ id, ...msg }]\r\n  }else{\r\n    sessionList[session].push({ id, ...msg })\r\n  }\r\n  // 保存\r\n  localStorage.setItem(storageKey, JSON.stringify(sessionList))\r\n\r\n  return id\r\n}\r\n\r\n// 获取一个聊天获取全部聊天\r\nlet getChat = (session) => {\r\n  let sessionList = JSON.parse(localStorage.getItem(storageKey)) || {}\r\n  if(session){\r\n    return sessionList[session] || []\r\n  }\r\n  return sessionList\r\n}\r\n\r\n// 删除一条聊天记录\r\nlet deleteMsg = (session, id) => {\r\n  // 获取\r\n  let sessionList = getChat()\r\n  // 聊天是否存在\r\n  if(!sessionList[session]){\r\n    return\r\n  }\r\n  // 删除记录\r\n  if(id){\r\n    sessionList[session] = sessionList[session].filter(item => item.id !== id)\r\n  }else {\r\n    sessionList[session] = []\r\n  }\r\n  // 保存\r\n  localStorage.setItem(storageKey, JSON.stringify(sessionList))\r\n}\r\n\r\n// 查找所有聊天记录\r\nlet search = (session, msg) => {\r\n  if(!msg){\r\n    msg = session\r\n    \r\n    // 获取\r\n    let sessionList = getChat()\r\n    return Object.keys(sessionList).map(session => {\r\n      return sessionList[session].filter(item => item.type === 'text' && item.msg.includes(msg))\r\n    })\r\n  }\r\n\r\n  let msgList = getChat(session)\r\n  let res = {}\r\n  res[session] = msgList.filter(item => item.type === 'text' && item.msg.includes(msg))\r\n  return res\r\n}\r\n\r\n// 修改某条聊天记录\r\nlet setMsg = (session, func) => {\r\n  // 获取\r\n  let sessionList = getChat()\r\n  // 修改\r\n  sessionList[session] = sessionList[session].map(func)\r\n  // 保存\r\n  localStorage.setItem(storageKey, JSON.stringify(sessionList))\r\n}\r\n\r\n\r\nexport {\r\n  addOne,\r\n  getChat,\r\n  deleteMsg,\r\n  search,\r\n  setMsg\r\n}","import React, { Component } from 'react';\r\nimport { uploadFile } from '../../api'\r\nimport { socket, received, userInfo } from '../../api/socket.js'\r\nimport { Avatar, Button, Icon, message, Upload } from 'antd'\r\nimport { baseURL } from '../../config'\r\nimport UserAvatar from '../../components/userAvatar'\r\nimport MsgList from '../../components/msgList'\r\nimport UserInfo from '../../components/userInfo'\r\nimport moment from 'moment'\r\nimport { getChat, addOne, setMsg, deleteMsg } from '../history'\r\n// import { reduce } from 'lodash'\r\nimport './style.less'\r\n\r\nclass Chat extends Component {\r\n\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      msg: '',\r\n      target: '*',\r\n      chatList: getChat('*'),\r\n      editName: false,\r\n      myName: '',\r\n      userList: [],\r\n      // 聊天室列表\r\n      sessionList: [],\r\n      // 左侧列表类型\r\n      leftListType: 'chat',\r\n    }\r\n\r\n    // 索引\r\n    this.indexes = {}\r\n  }\r\n\r\n  sendMsg = () => {\r\n\r\n    let { msg, myId, target, myName, avatar } = this.state\r\n\r\n    if(!msg){\r\n      message.warning('啥也没有输入，不让发送')\r\n      return;\r\n    }\r\n\r\n    let chat = {\r\n      type: 'text',\r\n      target: target,\r\n      msg: msg,\r\n      myId: myId,\r\n      myName: myName,\r\n      sendTime: new Date().getTime(),\r\n      loading: true,\r\n      avatar\r\n    }\r\n\r\n\r\n    socket.emit('chat', chat)\r\n\r\n    this.setChatList(chat)\r\n    this.setState({\r\n      msg: ''\r\n    })\r\n  }\r\n\r\n  upload = (e) => {\r\n\r\n    let { myId, target, myName, avatar } = this.state\r\n    let chat = {\r\n      type: 'file',\r\n      target: target,\r\n      msg: {\r\n        type: e.file.type,\r\n        file: window.URL.createObjectURL(e.file)\r\n      },\r\n      myId: myId,\r\n      myName: myName,\r\n      sendTime: new Date().getTime(),\r\n      loading: true,\r\n      avatar\r\n    }\r\n\r\n    let id = this.setChatList(chat)\r\n    \r\n    uploadFile(e.file).then((res) => {\r\n\r\n      setMsg(target, (item) => {\r\n        if(item.id === id) {\r\n          item.msg.file = res.data.path\r\n          item.msg.name = res.data.filename\r\n          item.msg.size = res.data.size\r\n        }\r\n        chat = item\r\n        return item\r\n      })\r\n      this.setState({\r\n        chatList: getChat(target)\r\n      })\r\n      socket.emit('chat', chat)\r\n    })\r\n  }\r\n\r\n  setChatList = (data) => {\r\n    let {  target } = this.state\r\n    let id = addOne(target, data)\r\n    this.setState({\r\n      chatList: getChat(target)\r\n    })\r\n    return id\r\n  }\r\n\r\n  clearHistory = () => {\r\n    deleteMsg(this.state.target)\r\n    this.setState({\r\n      chatList: getChat(this.state.target)\r\n    })\r\n  }\r\n\r\n  targetChange = (e) => {\r\n    this.setState({\r\n      target: e.target.value\r\n    })\r\n  }\r\n\r\n  writeMsg = (e) => {\r\n    this.setState({\r\n      msg: e.target.value\r\n    })\r\n  }\r\n\r\n  enter = (e) => {\r\n    let event = e.nativeEvent;\r\n    if (event.keyCode === 13 && !event.altKey && !event.ctrlKey) {\r\n      e.preventDefault && e.preventDefault();\r\n      this.sendMsg()\r\n      return;\r\n    }\r\n  }\r\n\r\n\r\n  editName = (e) => {\r\n    this.setState({\r\n      myName: e.target.value\r\n    })\r\n    localStorage.setItem('tj_chat_name', e.target.value)\r\n\r\n    let { myId } = this.state\r\n    socket.emit('editUser', { target: 'server', msg: 'change my name', myId: myId, myName: e.target.value })\r\n  }\r\n\r\n  editAvatar = (e) => {\r\n    this.setState({\r\n      avatar: e\r\n    })\r\n    localStorage.setItem('tj_chat_avatar', e)\r\n\r\n    let { myId } = this.state\r\n    socket.emit('editUser', { target: 'server', msg: 'change my avatar', myId: myId, avatar: e })\r\n  }\r\n\r\n  setLoading (ack) {\r\n    setMsg(this.state.target, (item) => {\r\n      if((item.target + '_' + item.sendTime) === ack){\r\n        item.loading = false\r\n      }\r\n      return item\r\n    })\r\n    this.setState({\r\n      chatList: getChat(this.state.target)\r\n    })\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (userInfo) {\r\n      this.setState({ ...userInfo() })\r\n      socket.emit('editUser', { target: 'server', msg: 'i need user list', ...userInfo() })\r\n    }\r\n    received((event, data) => {\r\n      // console.log(event, data)\r\n      switch (event) {\r\n        case 'addUser':\r\n          this.setState({ ...userInfo() })\r\n          break;\r\n        case 'chat':\r\n          this.setChatList(data)\r\n          break;\r\n        case 'users':\r\n          let { myId } = userInfo()\r\n          let res = Object.keys(data.msg).filter(key => key !== myId).map(item => data.msg[item])\r\n          this.setState({\r\n            userList: res.sort((a, b) => (b.connectTime - a.connectTime))\r\n          })\r\n          break;\r\n        case 'return':\r\n          this.setLoading(data.ack)\r\n          if (data.msg !== 'success') {\r\n            message.error(data.msg)\r\n          }\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    })\r\n  }\r\n\r\n  changeList = (type) => {\r\n    this.setState({\r\n      leftListType: type\r\n    })\r\n  }\r\n\r\n  render() {\r\n    let { msg, chatList, myName, myId, avatar, userList, leftListType } = this.state;\r\n\r\n    const config = {\r\n      name: 'file',\r\n      showUploadList: false,\r\n      customRequest: this.upload\r\n    }\r\n\r\n    return (\r\n      <div className=\"chat\">\r\n        <div className=\"main\">\r\n          <div className=\"left\">\r\n            <UserInfo myName={myName} myId={myId} avatar={avatar} editName={this.editName.bind(this)} editAvatar={this.editAvatar.bind(this)}></UserInfo>\r\n            <div className=\"actions\">\r\n              <div className=\"search\">\r\n                <div className=\"icon wechat_search\"></div>\r\n                <input type=\"text\" placeholder=\"搜索\"/>\r\n              </div>\r\n              <div className=\"tabs\">\r\n                <div className=\"tabs-item\" onClick={() => this.changeList('chat')}>\r\n                  <i className={leftListType === 'chat' ? 'wechat_chat_active': 'wechat_chat'}></i>\r\n                </div>\r\n                <div className=\"tabs-item\" onClick={() => this.changeList('friends')}>\r\n                  <i className={leftListType === 'friends' ? 'wechat_friends_active' : 'wechat_friends'}></i>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {\r\n              leftListType === 'friends' ? <div className=\"user-list\">\r\n                <ul>\r\n                  {\r\n                     userList.map((item, key) => {\r\n                      return (\r\n                        <li key={key}>\r\n                          <div className=\"warp\">\r\n                            <UserAvatar avatar={baseURL + item.avatar}></UserAvatar>\r\n                            <div className=\"info\">\r\n                              <span className=\"text\" style={{color: item.isLeave ? '#6b6f7c' : '#fff'}}>{item.myName}</span>\r\n                            </div>\r\n                              {/* {\r\n                                item.isLeave ? <Badge color=\"#999\" text=\"离线\" className=\"user-status-leave\"/> :\r\n                                  <Badge status=\"processing\" text=\"在线\" className=\"user-status\" />\r\n                              } */}\r\n                          </div>\r\n                        </li>\r\n                      )\r\n                    })\r\n                  }\r\n                </ul>\r\n              </div> : \r\n              <div className=\"user-list session-list\">\r\n                  <ul>\r\n                    <li className=\"list-active\">\r\n                      <div className=\"warp\">\r\n                        <div className=\"user-avatar\">\r\n                          <Avatar shape=\"square\" size=\"large\"><Icon type=\"usergroup-add\" /></Avatar>\r\n                        </div>\r\n                        <div className=\"info\">\r\n                          <span className=\"text\">所有人</span>\r\n                          <span className=\"text msg\">\r\n                            {\r\n                              chatList.length ? \r\n                              (chatList[chatList.length - 1].type === 'file' ? '[文件]' :chatList[chatList.length - 1].msg) : \r\n                              ''\r\n                            }\r\n                          </span>\r\n                        </div>\r\n                        <div className=\"time\">{chatList.length ? moment(chatList[chatList.length - 1].sendTime).format('HH:mm') : ''}</div>\r\n                      </div>\r\n                    </li>\r\n                  </ul>\r\n              </div>\r\n            }\r\n          </div>\r\n\r\n          <div className=\"right\" id=\"chat-right\">\r\n            <div className=\"main-msg-header\">\r\n              <span>所有人</span>\r\n            </div>\r\n\r\n            <MsgList chatList={chatList} clearHistory={this.clearHistory.bind(this)}/>\r\n\r\n            <div className=\"main-msg-send\">\r\n              <div className=\"toolbar\">\r\n                <Upload {...config}>\r\n                 <Icon type=\"folder\" className=\"toolbar-btn\"/>\r\n                </Upload>\r\n              </div>\r\n              <div className=\"main-msg-input\">\r\n                <textarea value={msg} onChange={this.writeMsg} onKeyDown={this.enter} autoFocus=\"autofocus\" ref=\"msgInput\"></textarea>\r\n              </div>\r\n              <div className=\"send-btn\">\r\n                <span></span>\r\n                <Button style={{ padding: '0 30px' }} onClick={this.sendMsg}>发送</Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          \r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Chat","import React, { Component } from 'react';\r\n\r\nclass MQ extends Component{\r\n\r\n  render() {\r\n    return (\r\n      <div>MQ</div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default MQ","import React, { Component } from 'react';\r\nimport { HashRouter,Route,Switch, Redirect } from 'react-router-dom'\r\nimport App from './App'\r\nimport Index from './moduls/home'\r\nimport Chat from './moduls/chat'\r\nimport MQ from './moduls/mq'\r\n\r\n\r\nexport default class Router extends Component {\r\n  \r\n  render () {\r\n    return (\r\n      <HashRouter>\r\n        <App>\r\n          <Switch>\r\n              <Route path=\"/home\" component={Index} />\r\n              <Route path=\"/chat\" component={Chat} />\r\n              <Route path=\"/MQ\" component={MQ} />\r\n              <Redirect to=\"/chat\" />\r\n          </Switch>\r\n        </App>\r\n      </HashRouter>\r\n    )\r\n  }\r\n}","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport Router from './router';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<Router />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}